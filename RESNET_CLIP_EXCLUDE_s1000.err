[rank: 0] Global seed set to 1000
Some weights of the model checkpoint at microsoft/BiomedVLP-CXR-BERT-general were not used when initializing BertModel: ['cls.predictions.transform.LayerNorm.bias', 'cls.predictions.transform.dense.weight', 'cls.predictions.decoder.bias', 'cls.predictions.transform.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.predictions.decoder.weight', 'cls.predictions.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Using 16bit None Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
`Trainer(val_check_interval=1.0)` was configured so validation will run at the end of the training epoch..
[rank: 0] Global seed set to 1000
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/1
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 1 processes
----------------------------------------------------------------------------------------------------

LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name           | Type               | Params
------------------------------------------------------
0 | img_backbone   | resnet_model       | 23.5 M
1 | img_projector  | ProjectionHeadCLIP | 1.3 M 
2 | mm_criterion   | CLIP_Loss          | 0     
3 | text_backbone  | bert_model         | 109 M 
4 | text_projector | ProjectionHeadCLIP | 657 K 
------------------------------------------------------
134 M     Trainable params
0         Non-trainable params
134 M     Total params
269.921   Total estimated model params size (MB)
SLURM auto-requeueing enabled. Setting signal handlers.
Epoch 0, global step 1187: 'val_loss' reached 3.86726 (best 3.86726), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=0-step=1187-v1.ckpt' as top 1
Epoch 1, global step 2374: 'val_loss' reached 3.75526 (best 3.75526), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=1-step=2374.ckpt' as top 1
Epoch 2, global step 3561: 'val_loss' reached 3.68700 (best 3.68700), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=2-step=3561.ckpt' as top 1
Epoch 3, global step 4748: 'val_loss' reached 3.62020 (best 3.62020), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=3-step=4748.ckpt' as top 1
Epoch 4, global step 5935: 'val_loss' reached 3.55566 (best 3.55566), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=4-step=5935.ckpt' as top 1
Epoch 5, global step 7122: 'val_loss' reached 3.50168 (best 3.50168), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=5-step=7122.ckpt' as top 1
Epoch 6, global step 8309: 'val_loss' reached 3.48042 (best 3.48042), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=6-step=8309.ckpt' as top 1
Epoch 7, global step 9496: 'val_loss' reached 3.44900 (best 3.44900), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=7-step=9496.ckpt' as top 1
Epoch 8, global step 10683: 'val_loss' was not in top 1
Epoch 9, global step 11870: 'val_loss' reached 3.35472 (best 3.35472), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=9-step=11870.ckpt' as top 1
Epoch 10, global step 13057: 'val_loss' reached 3.35254 (best 3.35254), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=10-step=13057.ckpt' as top 1
Epoch 11, global step 14244: 'val_loss' reached 3.33428 (best 3.33428), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=11-step=14244.ckpt' as top 1
Epoch 12, global step 15431: 'val_loss' reached 3.31686 (best 3.31686), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=12-step=15431.ckpt' as top 1
Epoch 13, global step 16618: 'val_loss' reached 3.28105 (best 3.28105), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=13-step=16618.ckpt' as top 1
Epoch 14, global step 17805: 'val_loss' was not in top 1
Epoch 15, global step 18992: 'val_loss' reached 3.24979 (best 3.24979), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=15-step=18992.ckpt' as top 1
Epoch 16, global step 20179: 'val_loss' reached 3.21371 (best 3.21371), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=16-step=20179.ckpt' as top 1
Epoch 17, global step 21366: 'val_loss' reached 3.20172 (best 3.20172), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=17-step=21366.ckpt' as top 1
Epoch 18, global step 22553: 'val_loss' reached 3.19818 (best 3.19818), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=18-step=22553.ckpt' as top 1
Epoch 19, global step 23740: 'val_loss' reached 3.19151 (best 3.19151), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=19-step=23740.ckpt' as top 1
Epoch 20, global step 24927: 'val_loss' reached 3.16068 (best 3.16068), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=20-step=24927.ckpt' as top 1
Epoch 21, global step 26114: 'val_loss' was not in top 1
Epoch 22, global step 27301: 'val_loss' reached 3.15864 (best 3.15864), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=22-step=27301.ckpt' as top 1
Epoch 23, global step 28488: 'val_loss' reached 3.13804 (best 3.13804), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=23-step=28488.ckpt' as top 1
Epoch 24, global step 29675: 'val_loss' reached 3.13114 (best 3.13114), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=24-step=29675.ckpt' as top 1
Epoch 25, global step 30862: 'val_loss' reached 3.08947 (best 3.08947), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=25-step=30862.ckpt' as top 1
Epoch 26, global step 32049: 'val_loss' was not in top 1
Epoch 27, global step 33236: 'val_loss' was not in top 1
Epoch 28, global step 34423: 'val_loss' reached 3.04314 (best 3.04314), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=28-step=34423.ckpt' as top 1
Epoch 29, global step 35610: 'val_loss' was not in top 1
Epoch 30, global step 36797: 'val_loss' was not in top 1
Epoch 31, global step 37984: 'val_loss' was not in top 1
Epoch 32, global step 39171: 'val_loss' reached 3.01753 (best 3.01753), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=32-step=39171.ckpt' as top 1
Epoch 33, global step 40358: 'val_loss' reached 3.00839 (best 3.00839), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=33-step=40358.ckpt' as top 1
Epoch 34, global step 41545: 'val_loss' was not in top 1
Epoch 35, global step 42732: 'val_loss' reached 2.96976 (best 2.96976), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=35-step=42732-v1.ckpt' as top 1
Epoch 36, global step 43919: 'val_loss' was not in top 1
Epoch 37, global step 45106: 'val_loss' was not in top 1
Epoch 38, global step 46293: 'val_loss' was not in top 1
Epoch 39, global step 47480: 'val_loss' reached 2.96797 (best 2.96797), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=39-step=47480.ckpt' as top 1
Epoch 40, global step 48667: 'val_loss' was not in top 1
Epoch 41, global step 49854: 'val_loss' reached 2.95941 (best 2.95941), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=41-step=49854.ckpt' as top 1
Epoch 42, global step 51041: 'val_loss' reached 2.91728 (best 2.91728), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=42-step=51041.ckpt' as top 1
Epoch 43, global step 52228: 'val_loss' was not in top 1
Epoch 44, global step 53415: 'val_loss' was not in top 1
Epoch 45, global step 54602: 'val_loss' was not in top 1
Epoch 46, global step 55789: 'val_loss' reached 2.91432 (best 2.91432), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=46-step=55789.ckpt' as top 1
Epoch 47, global step 56976: 'val_loss' was not in top 1
Epoch 48, global step 58163: 'val_loss' was not in top 1
Epoch 49, global step 59350: 'val_loss' reached 2.91262 (best 2.91262), saving model to '/gpfs/data/denizlab/Users/hh2740/MIMICCXR-MutliModal-SelfSupervision/model_saved/epoch=49-step=59350.ckpt' as top 1
`Trainer.fit` stopped: `max_epochs=50` reached.
